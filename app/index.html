<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width">
	<title>ScienceSuit</title>

	<style>
		p.FirstLetter 
		{
			font-size:1.3em;
			margin-left:10px;        
		}
		
		p.FirstLetter:first-letter 
		{
			font-size: 1.5em;         
			font-style: italic;     
			font-weight: bold;
		}
	</style>

	<link rel="stylesheet" href="css/common.css">
</head>




<div id="desktopmenu">	
	<ul class="desktopmenubar">

		<li class="singlemenu"><a class="active"  href="index.html">Home</a></li>
	
		<li class="dropdownmenu"> 
			<a class="dropbutton" href="#">Psychrometry</a>
	
			<div class="drop_menuitems">
				<a href="eng/psychrometrycalc.html">Calculator</a>
				<a href="learning/psychrometry/index.html">Simulations</a>
			</div>
		</li>

		<li class="singlemenu">
			<a href="pipmngr.html">PIP Manager</a>
		</li>
	</ul>	
</div>

	
<div id="mobilemenu" class="mobileoverlay">

	<div class="overlay-content">
		<a href="eng/psychrometrycalc.html">Psychrometry Calc</a>
		<a href="pipmngr.html">Python packages</a>
	</div>
</div>

<script src="mainmenu.js"></script>

<h1>ScienceSuit</h1>

<p class="FirstLetter">
	A feature-rich computing environment for engineers.</p>

<script>
	"use strict";

	let div = document.body.appendChild(document.createElement("div"));
	div.style.cssText = "border: 1px dashed red; width: fit-content;";
	let p = div.appendChild(document.createElement("p"));

	window.myapi.runcmd("py --list-paths").
	then(output=> 
	{
		
		p.innerHTML = "<b>Python installations:</b>";
		p.style.fontSize = "1.2em";

		const arr = output.split("\n");

		let ol = div.appendChild(document.createElement("ol"));
		ol.className = "linespaced";
		for(let path of arr)
		{
			if(path.length == 0) continue;
			let li = ol.appendChild(document.createElement("li"));
			li.innerHTML = path;

			if(path.includes("*"))
				li.style.color = "green";
		}

		let p_scisuit = div.appendChild(document.createElement("p"));
		let span = p_scisuit.appendChild(document.createElement("span"));

		span.innerHTML = "Checking status of <b>scisuit</b> package...";

		window.myapi.runcmd("python -m pip show scisuit").
		then(ouput=> 
		{
			span.innerHTML = "<b>scisuit</b> package &#x2713;";
			
		}).
		catch(error=>
		{
			span.innerHTML = "<b>scisuit</b> package is not installed: ";
			span.style.color = "red";

			let btn = p_scisuit.appendChild(document.createElement("button"));
			btn.innerHTML = "Install <b>scisuit</b>";

			btn.onclick = function(evt)
			{
				span.innerHTML = "<b>scisuit</b> is being installed...";
				btn.disabled = true;

				window.myapi.runcmd("python -m pip install scisuit").
				then(ouput=> 
				{
					p_scisuit.innerHTML = "<b>scisuit</b> package &#x2713;";	
				}).
				catch(error=>
				{
					span.innerHTML = "<b>scisuit</b> package could not be installed: ";
					span.style.color = "red";

					btn.disabled = true;
				});
			}
		});
	}).
	catch(error=>
	{
		p.innerText=error;
	});

	

</script>

</body>
</html>