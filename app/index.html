<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width">
	<title>ScienceSuit</title>

	<style>
		p.FirstLetter 
		{
			font-size:1.3em;
			margin-left:10px;        
		}
		
		p.FirstLetter:first-letter 
		{
			font-size: 1.5em;         
			font-style: italic;     
			font-weight: bold;
		}

		div.PyHomes
		{
			border: 1px dashed red; 
			width: 50%;
		}

		@media only screen and (max-width:600px) 
		{
			div.PyHomes
			{
				width: 80%;
			}
		}
	</style>

	<link rel="stylesheet" href="css/common.css">
</head>




<div id="desktopmenu">	
	<ul class="desktopmenubar">

		<li class="singlemenu"><a class="active"  href="index.html">Home</a></li>
	
		<li class="dropdownmenu"> 
			<a class="dropbutton" href="#">Psychrometry</a>
	
			<div class="drop_menuitems">
				<a href="eng/psychrometrycalc.html">Calculator</a>
				<a href="learning/psychrometry/index.html">Simulations</a>
			</div>
		</li>

		<li class="singlemenu">
			<a href="pipmngr.html">PIP Manager</a>
		</li>
	</ul>	
</div>

	
<div id="mobilemenu" class="mobileoverlay">

	<div class="overlay-content">
		<a href="eng/psychrometrycalc.html">Psychrometry Calc</a>
		<a href="pipmngr.html">Python packages</a>
	</div>
</div>

<script src="mainmenu.js"></script>

<h1>ScienceSuit</h1>

<p class="FirstLetter">
	A feature-rich computing environment for engineers.</p>

<script>
	"use strict";

	let div = document.body.appendChild(document.createElement("div"));
	div.className = "PyHomes";

	let pHeader = div.appendChild(document.createElement("p"));
	pHeader.innerHTML = "Python Management";
	pHeader.style.cssText = "text-align: center; color: red; font-weight: bold;";

	let p_PyHomes = div.appendChild(document.createElement("p"));

	window.myapi.runcmd("py -0").
	then(output=> 
	{	
		const arr = output.split("\n");
		arr.pop(); //the last element is with empty string

		let ol = div.appendChild(document.createElement("ol"));
		ol.className = "linespaced";
		for(let path of arr)
		{
			let li = ol.appendChild(document.createElement("li"));
			li.innerHTML = path;

			if(path.includes("*"))
				li.style.color = "green";
		}

		let p_scisuit = div.appendChild(document.createElement("p"));
		p_scisuit.innerHTML = "Checking status of <b>scisuit</b> package...";

		window.myapi.runcmd("py -m pip show scisuit").
		then(ouput=> 
		{
			p_scisuit.innerHTML = "<b>scisuit</b> package &#x2713;";
			
		}).
		catch(error=>
		{
			p_scisuit.innerHTML = "<b>scisuit</b> package is not installed ";
			
			let anchor = div.appendChild(document.createElement("a"));
			anchor.href="pipmngr.html";
			anchor.innerHTML = "Py Package Manager"
		});
	}).
	catch(error=>
	{
		p.innerText=error;
	});

	

</script>

</body>
</html>