<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width">
	<title>Package Manager</title>
	<style>
		table, tr{
			border: 1px solid;
			border-collapse: collapse;
		}

		td{
			padding-top: 6px;
			padding-bottom: 6px;
			border: 1px solid;
		}

		tr:first-child{
			font-weight: bold;
		}

		tr:nth-child(2n+2){
			background-color: antiquewhite;
		}

		tr:nth-child(2n+1){
			background-color: blanchedalmond;
		}

		#erroutput{
			background-color: rgb(180, 76, 76);
		}
	</style>
</head>


<body>
<h1>Python Packages</h1>

<p><a href="index.html">Main Screen</a></p>


<button id="btnInstalledModules">Installed Modules</button>


<div id="modules"></div>
<div id="pipoutput"></div>
<div id="erroutput"></div>


<script>
	const btn = document.querySelector('#btnInstalledModules');
	btn.addEventListener("click", (evt) => 
	{
		window.electron.runpy((error, output) => 
		{
			let s ="<table><tr><td>Name</td><td colspan=2>Location</td></tr>"
			if (error) 
			{
				console.error('Error:', error);
			} else 
			{
				let jsonData = JSON.parse(output);

				for (let i = 0; i <jsonData.length; i++) 
				{
					let e = jsonData[i];
					s += "<tr> \n";
					s += "<td>" + e.names + "</td>";
					s += "<td>" + e.locs + "</td>";
					s += "<td>" + "<button id=" + e.names +" class='pipinfo'>Info</button>" + "</td>"

					s += "</tr>";	
				}

				s += "</table>";
				let prg = document.getElementById("modules");
				prg.innerHTML=s;
			}
		}, "py/listmodules.py");
	}, false);

	function ShowInfo(event)
	{
		if(event.target.className === "pipinfo")
		{
			window.electron.runpy((error, output) => 
			{
				let errout = document.getElementById("erroutput");
				let prg = document.getElementById("pipoutput");
				if (error) 
				{
					errout.scrollIntoView();
					errout.innerText=error;
					prg.innerText="";
				} 
				else 
				{
					prg.scrollIntoView();
					errout.innerText = "";
					prg.innerText=output;
				}
			}, "-m pip show " + event.target.id);
		}
	}


	document.addEventListener("click", (event)=>
	{
		if(event.target === document.getElementsByTagName("button"));
		{
			ShowInfo(event);
		}
	});
	
</script>

</body>
</html>