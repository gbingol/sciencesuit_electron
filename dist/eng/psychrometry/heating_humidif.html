<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Heating with Humidification</title>

	<link href="../../css/common.css" rel="stylesheet">
	
	<style>
		table{
			margin-left: 10px;
			float: left;
			width: 50%;
			background-color: antiquewhite;
		}
		td{
			padding-top: 6px;
			padding-bottom: 6px;
		}

		td:nth-child(1)
		{
			font-weight: bold;
			max-width: 2em;
		}

		input[type=text]{
			width: 90%;
		}

		input[type=text]:focus {
			outline: 3px solid #FFCC00;
			box-shadow: 0 0 10px #FFCC00;
		}
		
		p.info
		{
			margin-right: 4em;
			font-size: large;
		}

		ol.question li{
			font-size: large;
			padding-top: 6px;
			padding-bottom: 6px;
		}

		div.img
		{
			display: flex;
			justify-content: center;
		}

		summary{
			cursor: pointer;
			width: fit-content;
		}

		summary:hover{
			background-color: burlywood;
		}

		div.hint
		{
			border: 2px dotted green; 
			width: fit-content;
		}

		@media only screen and (max-width:900px)
		{
			p.info{
				margin-right: auto;
			}
		}
    </style>

	<script src ="psyutil.js"></script>
	<script type="module" src="../../../renderer/dom/div_copydel.js" defer></script>
</head>


<body>


<script src="../../mainmenu.js"></script>


<h1>Heating with Humidification</h1>

<div class="img">
	<img src="imgs/heating_humidif.png" alt="">
</div>

<p class="info">
	An air conditioning system takes in outdoor air at 
	<span id ="T1">T<sub>1</sub></span>&deg;C and 
	<span id ="RH1">RH<sub>1</sub></span>% relative humidity at a steady rate of 
	<span id ="V1">V<sub>1</sub></span> (m<sup>3</sup>/time) 
	and conditions to 
	<span id ="T3">T<sub>3</sub></span>&deg;C, 
	<span id="RH3">RH<sub>3</sub></span>% relative humidity.</p>



<p class="info">
	The outdoor air is first heated to <span id="T2">T<sub>2</sub></span>&deg;C in the heating section 
	and then humidified by the injection of hot steam in the humidifying section. 
	Assume the whole process takes place at <span id="P">101</span>(kPa).</p>

<ol class="question">
	<li> Heat supply in the heating section (kJ/s)</li>
	<li> Mass flow rate of the steam required in the humidifying section.</li>
</ol>

<p style="font-size: small;"><b>Reference:</b>
	Cengel YA, Boles MA, Kanaoglu M (2019). 
	Thermodynamics: an engineering approach, 9th edition, McGraw-Hill Education.</p>

<p>&nbsp;</p>

<details>
	<summary>Hint</summary>
	<div class="hint">
		<img src="imgs/heating_humid_psychart.png">
		<p>Observe the following points:</p>
		<ol>
			<li>Absolute humidity at 1 is equal to 2.</li>
			<li>T<sub>1</sub>&lt;T<sub>2</sub>&lt; T<sub>3</sub></li>
			<li>RH<sub>1</sub>&lt; RH<sub>3</sub> &rarr; check actual psychrometric chart.</li>
		</ol>
		
	</div>
	</details>

<br>


<table id="inputtable">
	<tr>
		<td>P:</td>
		<td><input type="text" value="101" id="txtP" placeholder="Pressure (kPa)"></td>
	</tr>
	
	<tr style="color: blue;">
		<td>T<sub>1</sub>: </label></td>
		<td><input type="text" id="txtT1" placeholder="Inlet temperature 째C"></td>
	</tr>

	<tr style="color: blue;">
		<td>RH<sub>1</sub>: </label></td>
		<td><input type="text" id="txtRH1" placeholder="Inlet relative humidity %"></td>
	</tr>

	<tr style="color: blue;">
		<td>V<sub>1</sub>: </label></td>
		<td><input type="text" id="txtV1" placeholder="Inlet flow rate m3/time"></td>
	</tr>
	
	<tr style="color: red;">
		<td>T<sub>2</sub>: </label></td>
		<td><input type="text" id="txtT2" placeholder="Heating temperature 째C"></td>
	</tr>

	<tr style="color: green;">
		<td>T<sub>3</sub>: </label></td>
		<td><input type="text" id="txtT3" placeholder="째Outlet temperature 째C"></td>
	</tr>
	
	<tr style="color: green;">
		<td>RH<sub>3</sub>: </label></td>
		<td><input type="text" id="txtRH3" placeholder="Outlet relative humidity %"></td>
	</tr>
	
	<tr>
		<td colspan="2" style="text-align: center; padding-top: 12px;">
			<label style="float: left;" for="digits">Digits:</label>
			<input style="width: 3em; float: left;" type="number" value="3" min="1" max="6" id="txtDigits">
			
			<button id="compute" type="button">Compute</button>
		</td>
	</tr>
		
</table>
	
<div id="info"></div>

<script type="module">
	"use strict";

	import {round} from '../../js/sci_math.js';

	const btn = document.getElementById('compute');
	const txtP =  document.getElementById('txtP');

	const txtT1 =  document.getElementById('txtT1');
	const txtRH1 =  document.getElementById('txtRH1');
	const txtV1 =  document.getElementById('txtV1');

	const txtT2 =  document.getElementById('txtT2');
	const txtT3 =  document.getElementById('txtT3');
	const txtRH3 =  document.getElementById('txtRH3');

	addInputListener(txtP, "P", "P");
	addInputListener(txtT1, "T1", "T<sub>1</sub>");
	addInputListener(txtRH1, "RH1", "RH<sub>1</sub>");
	addInputListener(txtV1, "V1", "V<sub>1</sub>");
	addInputListener(txtT2, "T2", "T<sub>2</sub>");
	addInputListener(txtRH3, "RH3", "RH<sub>3</sub>");
	addInputListener(txtT3, "T3", "T<sub>3</sub>");

	const txtDigits =  document.getElementById('txtDigits');


	
	function compute(P, T1, RH1, V1, T2, T3, RH3)
	{
		let st1 = window.api.psychrometry({"tdb":T1, "rh":RH1, "p":P});
		
		let v1 = st1.V()
		let h1 = st1.H()
		let w1 = st1.W()

		//(m3/time) / (m3/kg da) = kg da /time
		let ma = V1/v1

		//simple heating
		let w2 = w1;

		let st2 = window.api.psychrometry({"tdb":T2, "w":w2, "p":P});
		let h2 = st2.H()

		let st3 = window.api.psychrometry({"tdb":T3, "rh":RH3, "p":P});
		let w3 = st3.W()

		let Q = ma*(h2-h1)
		let mw = ma*(w3-w1)

		return [Q, mw]
	}

	btn.addEventListener("click", (evt) => 
	{
		let infoDiv = document.querySelector("#info");
		if(!checkInputs())
			return true;

		let P = parseFloat(txtP.value)*1000; //Pa
		let T1 = parseFloat(txtT1.value);
		let RH1 = parseFloat(txtRH1.value);
		let V1 = parseFloat(txtV1.value);
		let T2 = parseFloat(txtT2.value);
		let RH3= parseFloat(txtRH3.value);
		let T3 = parseFloat(txtT3.value);

		let digits = parseInt(txtDigits.value);

		try
		{
			if(T1>=T2)
				throw new Error("T<sub>1</sub> &lt; T<sub>2</sub> expected.");

			if(RH1>=RH3)
				throw new Error("RH<sub>1</sub> &lt; RH<sub>3</sub> expected.");

			const [Q, mw] = compute(P, T1, RH1, V1, T2, T3, RH3);

			let s = "<i>Input values</i> <br>";
			s += "<b>Pressure</b> = " + txtP.value + " kPa <br>";
			s += "<b>T<sub>1</sub></b> = " + txtT1.value + " &deg;C <br>";
			s += "<b>RH<sub>1</sub></b> = " + txtRH1.value + " % <br>";
			s += "<b>V<sub>1</sub></b> = " + txtV1.value + " m<sup>3</sup> / time <br>";
			s += "<b>T<sub>2</sub></b> = " + txtT2.value + " &deg;C <br>";
			s += "<b>T<sub>3</sub></b> = " + txtT3.value + " &deg;C <br>";
			s += "<b>RH<sub>3</sub></b> = " + txtRH3.value + " % <br>";

			s += "<br><i>Output values</i> <br>";

			s += "<b>Heat supply = </b>" + round(Q, digits) + " kJ / time <br>";
			s += "<b>Flow ratel = </b>" + round(mw, digits) + " kg / time <br>";
			
			let outDiv = document.body.appendChild(document.createElement("div-copydel"));
			outDiv.innerHTML = s;
			outDiv.scrollIntoView();

			infoDiv.style.display = "none";
		}
		catch(e)
		{
			infoDiv.style.display = "inline";
			infoDiv.innerHTML = e;
		}
	});
</script>

</body>
</html>